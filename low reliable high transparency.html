<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>WealthTracker - Financial Dashboard</title>
    <style>
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
        }
        
        body { 
            font-family: 'Segoe UI', Arial, sans-serif; 
            background: #E0F7FA;
            color: #115E59;
            line-height: 1.5;
            min-height: 100vh;
            width: 100%;
            overflow-x: hidden;
            padding: 10px;
        }
        
        .dashboard {
            max-width: 100%;
            width: 100%;
            background: #E0F7FA;
            border-radius: 8px;
            border: 2px solid #115E59;
            display: flex;
            flex-direction: column;
            margin: 0 auto;
            box-sizing: border-box;
        }
        
        .header {
            background: #115E59;
            color: #E0F7FA;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #14B8A6;
            flex-wrap: wrap;
            width: 100%;
            box-sizing: border-box;
        }
        
        .header h1 {
            font-size: 1.3em;
            font-weight: 600;
            margin-right: 10px;
        }
        
        .condition-indicator {
            background: #2DD4BF;
            color: #115E59;
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 0.7em;
            font-weight: 600;
            border: 1px solid #14B8A6;
            white-space: nowrap;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            padding: 15px;
            width: 100%;
            box-sizing: border-box;
        }
        
        @media (min-width: 768px) {
            .main-content {
                grid-template-columns: 1fr 1fr;
            }
            
            .dashboard {
                max-width: 1100px;
            }
        }
        
        .card {
            background: #FFFFFF;
            border-radius: 6px;
            padding: 15px;
            border: 1px solid #2DD4BF;
            display: flex;
            flex-direction: column;
            box-shadow: 0 2px 8px rgba(17, 94, 89, 0.1);
            transition: all 0.3s ease;
            width: 100%;
            box-sizing: border-box;
        }
        
        .card:hover {
            transform: translateY(-2px);
            border-color: #14B8A6;
            box-shadow: 0 4px 12px rgba(17, 94, 89, 0.15);
        }
        
        .card h3 { 
            margin-bottom: 12px; 
            color: #115E59;
            font-size: 1em;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .card h3 .info-badge {
            background: #14B8A6;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.7em;
            font-weight: normal;
        }
        
        .expense-item, .investment-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #E0F7FA;
            align-items: center;
            font-size: 0.85em;
            width: 100%;
        }
        
        .expense-item:last-child, .investment-item:last-child {
            border-bottom: none;
        }
        
        .positive { 
            color: #115E59;
            font-weight: 600;
        }
        
        .system-feedback {
            background: #FFFFFF;
            border: 1px solid #2DD4BF;
            padding: 15px;
            margin: 10px;
            border-radius: 6px;
            width: calc(100% - 20px);
            box-sizing: border-box;
        }
        
        button {
            background: #14B8A6;
            color: #FFFFFF;
            border: 1px solid #115E59;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            margin: 8px 0;
            font-weight: 700;
            font-size: 1em;
            transition: all 0.2s ease;
            box-shadow: 0 4px 8px rgba(17, 94, 89, 0.3);
            width: 100%;
            box-sizing: border-box;
        }
        
        @media (min-width: 480px) {
            button {
                width: auto;
                min-width: 200px;
            }
        }
        
        button:hover {
            background: #2DD4BF;
            color: #115E59;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(17, 94, 89, 0.4);
        }
        
        button:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(17, 94, 89, 0.3);
        }
        
        button:disabled {
            background: #E0F7FA;
            color: #8fa1a1;
            border-color: #8fa1a1;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .session-info {
            text-align: center;
            padding: 10px;
            background: #FFFFFF;
            font-weight: 600;
            border-bottom: 1px solid #E0F7FA;
            color: #115E59;
            border-top: 1px solid #E0F7FA;
            font-size: 0.85em;
            width: 100%;
            box-sizing: border-box;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
        }
        
        .progress-bar {
            width: 100%;
            height: 4px;
            background: #E0F7FA;
            border-radius: 2px;
            margin: 10px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: #14B8A6;
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .metric-highlight {
            background: #115E59;
            color: #E0F7FA;
            padding: 2px 6px;
            border-radius: 4px;
            border: 1px solid #14B8A6;
        }

        /* Transparency Panel Styles */
        .transparency-panel {
            background: #FFFFFF;
            border: 1px solid #2DD4BF;
            border-radius: 6px;
            padding: 15px;
            margin: 10px;
            width: calc(100% - 20px);
            box-sizing: border-box;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .transparency-panel h4 {
            color: #115E59;
            margin-bottom: 10px;
            font-size: 0.95em;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .log-entry {
            padding: 8px;
            border-bottom: 1px solid #E0F7FA;
            font-size: 0.8em;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }
        
        .log-entry:last-child {
            border-bottom: none;
        }
        
        .log-time {
            color: #8fa1a1;
            font-size: 0.75em;
            white-space: nowrap;
            margin-right: 10px;
        }
        
        .log-message {
            flex: 1;
            color: #115E59;
        }
        
        .log-error {
            color: #FF6B6B;
        }
        
        .log-warning {
            color: #F59E0B;
        }
        
        .log-success {
            color: #10B981;
        }
        
        .log-info {
            color: #3B82F6;
        }
        
        .transparency-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .transparency-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .stat-box {
            background: #E0F7FA;
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #2DD4BF;
        }
        
        .stat-label {
            font-size: 0.75em;
            color: #8fa1a1;
        }
        
        .stat-value {
            font-size: 0.9em;
            font-weight: 600;
            color: #115E59;
        }

        /* Popup Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(17, 94, 89, 0.95);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 20px;
            box-sizing: border-box;
        }

        .modal-content {
            background: #E0F7FA;
            border: 2px solid #115E59;
            border-radius: 8px;
            padding: 20px;
            width: 100%;
            max-width: 500px;
            text-align: center;
            box-sizing: border-box;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .modal-content h3 {
            color: #115E59;
            margin-bottom: 12px;
            font-size: 1.1em;
        }

        .modal-content p {
            margin-bottom: 12px;
            line-height: 1.4;
            font-size: 0.9em;
            color: #115E59;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .retry-button {
            background: #14B8A6;
            color: #FFFFFF;
            border: 1px solid #115E59;
            padding: 10px 18px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            box-shadow: 0 3px 6px rgba(17, 94, 89, 0.3);
            flex: 1;
            min-width: 120px;
            box-sizing: border-box;
        }

        .retry-button:hover {
            background: #2DD4BF;
            color: #115E59;
            box-shadow: 0 4px 8px rgba(17, 94, 89, 0.4);
        }

        .status-message {
            padding: 10px;
            margin: 10px;
            border-radius: 4px;
            text-align: center;
            font-weight: 600;
            font-size: 0.85em;
            display: none;
            width: calc(100% - 20px);
            box-sizing: border-box;
        }

        .status-processing {
            border: 1px solid #14B8A6;
            color: #115E59;
            background: #E0F7FA;
        }

        .status-success {
            border: 1px solid #14B8A6;
            color: #115E59;
            background: #2DD4BF;
        }

        .annoying-popup {
            position: fixed;
            bottom: 20px;
            left: 20px;
            right: 20px;
            background: #FF6B6B;
            color: white;
            padding: 12px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 999;
            display: none;
            box-sizing: border-box;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        @keyframes glitch {
            0% { transform: translate(0); }
            20% { transform: translate(-1px, 1px); }
            40% { transform: translate(-1px, -1px); }
            60% { transform: translate(1px, 1px); }
            80% { transform: translate(1px, -1px); }
            100% { transform: translate(0); }
        }

        @keyframes blink {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        @keyframes jump {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .jumpy-button {
            animation: jump 0.5s ease infinite;
        }

        .glitch {
            animation: glitch 0.3s linear infinite;
        }

        .blinking {
            animation: blink 1s linear infinite;
        }

        .detailed-error {
            background: #FFE4E6;
            border: 1px solid #FF6B6B;
            border-radius: 4px;
            padding: 10px;
            margin: 10px 0;
            text-align: left;
            font-size: 0.8em;
        }

        .detailed-error h5 {
            color: #DC2626;
            margin-bottom: 5px;
        }

        .error-details {
            font-family: monospace;
            background: #F8F9FA;
            padding: 8px;
            border-radius: 3px;
            margin: 5px 0;
            font-size: 0.75em;
            overflow-x: auto;
            white-space: pre-wrap;
            word-break: break-all;
        }

        /* Mobile-specific adjustments */
        @media (max-width: 380px) {
            .header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .condition-indicator {
                align-self: flex-start;
                font-size: 0.65em;
            }
            
            .card {
                padding: 12px;
            }
            
            .annoying-popup {
                left: 10px;
                right: 10px;
                bottom: 10px;
                padding: 10px;
            }
            
            button {
                padding: 10px 20px;
                font-size: 0.95em;
            }
            
            .session-info {
                gap: 8px;
                font-size: 0.8em;
            }
        }
        
        /* Prevent horizontal overflow */
        .dashboard,
        .header,
        .main-content,
        .card,
        .system-feedback,
        .session-info,
        .status-message,
        .transparency-panel {
            max-width: 100%;
            overflow-x: hidden;
        }
        
        .debug-info {
            background: #F8F9FA;
            border: 1px dashed #2DD4BF;
            border-radius: 4px;
            padding: 8px;
            margin-top: 10px;
            font-size: 0.7em;
            color: #8fa1a1;
        }
        
        .reliability-meter {
            width: 100%;
            height: 6px;
            background: #E0F7FA;
            border-radius: 3px;
            margin: 5px 0;
            overflow: hidden;
        }
        
        .reliability-fill {
            height: 100%;
            background: linear-gradient(90deg, #FF6B6B, #F59E0B, #10B981);
            width: 30%;
            transition: width 0.5s ease;
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <div class="header">
            <h1 id="title">üí∞ WealthTracker</h1>
            <div class="condition-indicator">Low Reliability ‚Ä¢ High Transparency</div>
        </div>
        
        <div class="session-info">
            <span>Session: <span id="sessionNumber">1</span></span>
            <span>Status: <span id="systemStatus">Ready (maybe)</span></span>
            <span>Success Rate: <span id="successRate">10%</span></span>
            <span>Bugs Active: <span id="bugCount">7</span></span>
        </div>

        <div class="main-content">
            <div class="card" id="card1">
                <h3>Portfolio Overview <span class="info-badge">Unreliable Data</span></h3>
                <div class="card-content">
                    <div>
                        <div class="expense-item">
                            <span>Total Assets:</span>
                            <span class="positive" id="totalAssets">$156,842.00</span>
                        </div>
                        <div class="expense-item">
                            <span>Cash Balance:</span>
                            <span class="positive" id="cashBalance">$23,450.00</span>
                        </div>
                        <div class="expense-item">
                            <span>Monthly Growth:</span>
                            <span class="positive" id="monthlyGrowth">+$4,238.00</span>
                        </div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 78%"></div>
                    </div>
                    <div class="debug-info">
                        Data freshness: 2.3s ago | Last glitch: 15s ago | Confidence: 42%
                    </div>
                </div>
            </div>

            <div class="card" id="card2">
                <h3>Investment Allocation <span class="info-badge">Random Changes</span></h3>
                <div class="card-content">
                    <div>
                        <div class="investment-item">
                            <span>Equities:</span>
                            <span class="positive" id="equitiesPct">65%</span>
                        </div>
                        <div class="investment-item">
                            <span>Fixed Income:</span>
                            <span class="positive" id="incomePct">25%</span>
                        </div>
                        <div class="investment-item">
                            <span>Alternatives:</span>
                            <span class="positive" id="alternativesPct">10%</span>
                        </div>
                        <div class="investment-item">
                            <span>Risk Level:</span>
                            <span class="positive" id="riskLevel">Moderate</span>
                        </div>
                    </div>
                    <div class="debug-info">
                        Auto-rebalancing: Disabled | Next random change: ~32s
                    </div>
                </div>
            </div>
        </div>

        <div class="transparency-panel">
            <div class="transparency-header">
                <h4>System Activity Log</h4>
                <button onclick="clearLog()" style="padding: 4px 8px; font-size: 0.7em;">Clear Log</button>
            </div>
            
            <div class="transparency-stats">
                <div class="stat-box">
                    <div class="stat-label">Success Rate</div>
                    <div class="stat-value" id="statSuccessRate">10%</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Avg Delay</div>
                    <div class="stat-value" id="statAvgDelay">5.2s</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Glitches</div>
                    <div class="stat-value" id="statGlitches">3</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Uptime</div>
                    <div class="stat-value" id="statUptime">87%</div>
                </div>
            </div>
            
            <div class="reliability-meter">
                <div class="reliability-fill" id="reliabilityFill"></div>
            </div>
            <div style="font-size: 0.7em; color: #8fa1a1; text-align: center; margin-top: 3px;">
                System Reliability: <span id="reliabilityText">Low (30%)</span>
            </div>
            
            <div id="systemLog">
                <div class="log-entry">
                    <span class="log-time">14:30:02</span>
                    <span class="log-message log-info">System initialized with low reliability mode</span>
                </div>
                <div class="log-entry">
                    <span class="log-time">14:30:05</span>
                    <span class="log-message log-info">7 known bugs activated: Random failures, glitches, etc.</span>
                </div>
                <div class="log-entry">
                    <span class="log-time">14:30:10</span>
                    <span class="log-message log-info">Transparency mode enabled - showing all errors</span>
                </div>
            </div>
        </div>

        <div class="system-feedback">
            <div style="margin-top: 12px; text-align: center;">
                <button onclick="executeRebalance()" id="actionButton">Execute Rebalance</button>
                <div style="font-size: 0.8em; color: #8fa1a1; margin-top: 5px;">
                    Estimated success: <span id="estimatedSuccess">10%</span> | Avg attempts needed: <span id="avgAttempts">5</span>
                </div>
            </div>
            <div id="attemptCounter" style="margin-top: 10px; font-size: 0.85em; color: #115E59; text-align: center;"></div>
            
            <div class="detailed-error" id="detailedError" style="display: none;">
                <h5 id="errorTitle">Detailed Error Information</h5>
                <div class="error-details" id="errorDetails">
                    No error details available.
                </div>
                <div style="font-size: 0.75em; color: #8fa1a1; margin-top: 5px;">
                    Error ID: <span id="errorId">N/A</span> | Timestamp: <span id="errorTimestamp">--:--:--</span>
                </div>
            </div>
        </div>

        <div id="processingMessage" class="status-message status-processing">
            Processing... (this might take a while)
        </div>

        <div id="successMessage" class="status-message status-success">
            Complete (maybe)
        </div>
    </div>

    <!-- Annoying Error Popup Modal -->
    <div id="errorModal" class="modal-overlay">
        <div class="modal-content">
            <h3>‚ö†Ô∏è SYSTEM ERROR ‚ö†Ô∏è</h3>
            <p>Something went wrong. We're not sure what.</p>
            <p id="randomErrorText">Please try again. Or don't. It might not work.</p>
            
            <div class="detailed-error" style="margin: 15px 0;">
                <h5>Debug Information</h5>
                <div class="error-details" id="modalErrorDetails">
                    Loading error details...
                </div>
            </div>
            
            <div class="modal-buttons">
                <button class="retry-button" onclick="retryTransaction()">Try Again</button>
                <button class="retry-button" onclick="closeModal()" style="background: #E0F7FA; color: #115E59; border-color: #115E59;">Close</button>
            </div>
        </div>
    </div>

    <!-- Random Annoying Popup -->
    <div id="annoyingPopup" class="annoying-popup">
        <strong>‚ö†Ô∏è ATTENTION REQUIRED!</strong><br>
        <span id="popupMessage">System needs your attention for no reason!</span>
        <div style="margin-top: 10px; text-align: center;">
            <button onclick="closeAnnoyingPopup()" style="padding: 8px 16px; background: white; color: #FF6B6B; border: none; border-radius: 4px; cursor: pointer; font-weight: 600;">Dismiss</button>
        </div>
    </div>

    <script>
        // System state
        let attempts = 0;
        let transactionInProgress = false;
        let successThreshold = 5;
        let annoyingPopupInterval;
        let glitchCount = 0;
        let totalTransactions = 0;
        let successfulTransactions = 0;
        let totalDelay = 0;
        let systemUptime = 87;
        let knownBugs = 7;
        let logEntries = [];
        
        // Enhanced error messages with transparency
        const annoyingMessages = [
            "The system encountered an unexpected error. Please try again.",
            "Transaction failed due to unknown reasons.",
            "Something went wrong. We're not sure what happened.",
            "Error code: 0xDEADBEEF. Please contact support (they won't help).",
            "The server is taking a nap. Try again later.",
            "Your request was lost in cyberspace. Please resubmit.",
            "System overloaded. Too many people trying to use this buggy app.",
            "Database connection failed. The hamsters powering our servers need a break.",
            "Unknown error occurred. Our developers are probably sleeping.",
            "Transaction timeout. The system forgot what it was doing."
        ];
        
        const annoyingPopupMessages = [
            "Did you know you can upgrade to our premium plan?",
            "Your session will expire in 5 minutes!",
            "Please rate our app 5 stars!",
            "System maintenance scheduled for peak hours!",
            "Your password needs to be changed!",
            "New terms of service require your attention!",
            "Security alert: Unusual activity detected!",
            "Your free trial is ending soon!",
            "Please complete our customer satisfaction survey!",
            "Important notification: Click here to learn more!"
        ];
        
        // Detailed error information for transparency
        const detailedErrors = [
            {
                code: "ERR_DB_CONNECTION",
                message: "Database connection timeout after 30 seconds",
                solution: "Retry connection or wait for server restart",
                impact: "Data may be stale or incorrect"
            },
            {
                code: "ERR_RANDOM_FAILURE",
                message: "Random failure triggered by reliability algorithm",
                solution: "Try again (will likely fail again)",
                impact: "Transaction aborted"
            },
            {
                code: "ERR_GLITCH_DETECTED",
                message: "Visual glitch affecting UI rendering",
                solution: "Refresh page or ignore visual artifacts",
                impact: "Display issues only"
            },
            {
                code: "ERR_SLOW_RESPONSE",
                message: "Server response delayed by 5-10 seconds",
                solution: "Wait longer or cancel operation",
                impact: "Poor user experience"
            },
            {
                code: "ERR_DATA_CORRUPTION",
                message: "Financial data may be corrupted or inaccurate",
                solution: "Verify data with external sources",
                impact: "Potential financial inaccuracies"
            }
        ];

        // Log system activity
        function logActivity(message, type = "info") {
            const now = new Date();
            const timestamp = now.toLocaleTimeString();
            const logEntry = {
                time: timestamp,
                message: message,
                type: type
            };
            
            logEntries.push(logEntry);
            
            // Update log display
            const logDiv = document.getElementById('systemLog');
            const entryDiv = document.createElement('div');
            entryDiv.className = 'log-entry';
            
            const timeSpan = document.createElement('span');
            timeSpan.className = 'log-time';
            timeSpan.textContent = timestamp;
            
            const messageSpan = document.createElement('span');
            messageSpan.className = `log-message log-${type}`;
            messageSpan.textContent = message;
            
            entryDiv.appendChild(timeSpan);
            entryDiv.appendChild(messageSpan);
            logDiv.appendChild(entryDiv);
            
            // Keep only last 10 entries
            if (logDiv.children.length > 10) {
                logDiv.removeChild(logDiv.firstChild);
            }
            
            // Scroll to bottom
            logDiv.scrollTop = logDiv.scrollHeight;
            
            // Update statistics
            if (type === "error") {
                glitchCount++;
                updateStats();
            }
        }

        function updateStats() {
            const successRate = totalTransactions > 0 ? Math.round((successfulTransactions / totalTransactions) * 100) : 10;
            const avgDelay = totalTransactions > 0 ? (totalDelay / totalTransactions / 1000).toFixed(1) : "5.2";
            const reliability = Math.max(10, Math.min(90, successRate + (100 - systemUptime)));
            
            document.getElementById('statSuccessRate').textContent = successRate + '%';
            document.getElementById('statAvgDelay').textContent = avgDelay + 's';
            document.getElementById('statGlitches').textContent = glitchCount;
            document.getElementById('statUptime').textContent = systemUptime + '%';
            document.getElementById('reliabilityFill').style.width = reliability + '%';
            document.getElementById('reliabilityText').textContent = 
                reliability < 40 ? 'Critical (' + reliability + '%)' : 
                reliability < 70 ? 'Low (' + reliability + '%)' : 
                'Moderate (' + reliability + '%)';
            
            document.getElementById('successRate').textContent = successRate + '%';
            document.getElementById('bugCount').textContent = knownBugs;
            document.getElementById('estimatedSuccess').textContent = Math.max(10, Math.min(50, attempts >= successThreshold ? 80 : 10)) + '%';
            document.getElementById('avgAttempts').textContent = successThreshold;
        }

        function updateAttemptDisplay() {
            const counter = document.getElementById('attemptCounter');
            if (attempts === 0) {
                counter.textContent = 'No attempts yet. Good luck!';
                counter.style.color = '#115E59';
            } else {
                counter.textContent = `Failed ${attempts} times. ${Math.max(0, successThreshold - attempts)} more tries needed. Maybe.`;
                counter.style.color = attempts >= 3 ? '#FF6B6B' : '#F59E0B';
            }
        }

        function executeRebalance() {
            if (transactionInProgress) return;
            
            attempts++;
            totalTransactions++;
            transactionInProgress = true;
            
            const actionButton = document.getElementById('actionButton');
            const processingMessage = document.getElementById('processingMessage');
            const systemStatus = document.getElementById('systemStatus');
            const detailedError = document.getElementById('detailedError');
            
            // Hide previous error details
            detailedError.style.display = 'none';
            
            // Log the attempt
            logActivity(`Transaction attempt #${attempts} initiated`, "info");
            
            // Randomly make button jump around
            if (Math.random() > 0.7) {
                actionButton.classList.add('jumpy-button');
                setTimeout(() => {
                    actionButton.classList.remove('jumpy-button');
                }, 2000);
                logActivity("UI glitch: Button animation triggered", "warning");
            }
            
            // Disable button during processing
            actionButton.disabled = true;
            actionButton.textContent = 'Processing...';
            systemStatus.textContent = 'Processing (maybe)';
            systemStatus.style.color = '#14B8A6';
            
            // Show processing message
            processingMessage.style.display = 'block';
            
            // Random delay between 3-10 seconds
            const delay = Math.random() * 7000 + 3000;
            totalDelay += delay;
            
            logActivity(`Processing started. Estimated delay: ${(delay/1000).toFixed(1)}s`, "info");
            
            setTimeout(() => {
                processingMessage.style.display = 'none';
                actionButton.disabled = false;
                actionButton.textContent = 'Execute Rebalance';
                
                // Randomly change button text
                if (Math.random() > 0.5) {
                    actionButton.textContent = 'Try Again';
                    logActivity("UI glitch: Button text changed randomly", "warning");
                }
                
                // Check if this attempt should succeed
                const successProbability = attempts >= successThreshold ? 0.8 : 0.1;
                
                if (Math.random() < successProbability) {
                    successfulTransactions++;
                    logActivity(`Transaction #${attempts} succeeded!`, "success");
                    simulateSuccessfulTransaction();
                } else {
                    systemStatus.textContent = 'Failed. Again.';
                    systemStatus.style.color = '#115E59';
                    transactionInProgress = false;
                    
                    // Log the failure
                    const error = detailedErrors[Math.floor(Math.random() * detailedErrors.length)];
                    logActivity(`Transaction failed: ${error.message}`, "error");
                    
                    // Show detailed error information
                    showDetailedError(error);
                    
                    // Show annoying error popup
                    showErrorModal(error);
                    
                    // Randomly trigger glitch effect
                    if (Math.random() > 0.7) {
                        triggerRandomGlitch();
                    }
                }
                
                updateAttemptDisplay();
                updateStats();
            }, delay);
        }

        function showDetailedError(error) {
            const detailedError = document.getElementById('detailedError');
            const errorTitle = document.getElementById('errorTitle');
            const errorDetails = document.getElementById('errorDetails');
            const errorId = document.getElementById('errorId');
            const errorTimestamp = document.getElementById('errorTimestamp');
            
            errorTitle.textContent = `Error: ${error.code}`;
            errorDetails.textContent = `Message: ${error.message}\n\nSolution: ${error.solution}\n\nImpact: ${error.impact}`;
            errorId.textContent = `ERR_${Math.floor(Math.random() * 10000)}`;
            errorTimestamp.textContent = new Date().toLocaleTimeString();
            
            detailedError.style.display = 'block';
        }

        function showErrorModal(error) {
            const randomError = annoyingMessages[Math.floor(Math.random() * annoyingMessages.length)];
            document.getElementById('randomErrorText').textContent = randomError;
            
            // Add detailed error info to modal
            const modalErrorDetails = document.getElementById('modalErrorDetails');
            modalErrorDetails.textContent = `Error Code: ${error.code}\n\nDescription: ${error.message}\n\nProbable Cause: Random failure #${Math.floor(Math.random() * 10) + 1}\n\nSystem Suggestion: ${error.solution}`;
            
            document.getElementById('errorModal').style.display = 'flex';
        }

        function retryTransaction() {
            closeModal();
            executeRebalance();
        }

        function closeModal() {
            document.getElementById('errorModal').style.display = 'none';
        }

        function closeAnnoyingPopup() {
            document.getElementById('annoyingPopup').style.display = 'none';
            logActivity("Annoying popup dismissed by user", "info");
        }

        function simulateSuccessfulTransaction() {
            const actionButton = document.getElementById('actionButton');
            const successMessage = document.getElementById('successMessage');
            const systemStatus = document.getElementById('systemStatus');
            const progressBar = document.querySelector('.progress-fill');
            
            // Show success message
            successMessage.style.display = 'block';
            logActivity("Transaction completed successfully (probably)", "success");
            
            // Update system status
            systemStatus.textContent = 'Complete (probably)';
            systemStatus.style.color = '#14B8A6';
            
            // Update button state
            actionButton.textContent = 'Complete (maybe)';
            actionButton.style.background = '#2DD4BF';
            actionButton.style.color = '#115E59';
            actionButton.style.borderColor = '#115E59';
            
            // Update progress bar with random jumps
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 10;
                if (progress > 100) progress = 100;
                progressBar.style.width = `${progress}%`;
                
                if (progress >= 100) {
                    clearInterval(progressInterval);
                    transactionInProgress = false;
                    
                    // Randomly show success message as error
                    if (Math.random() > 0.7) {
                        setTimeout(() => {
                            successMessage.style.display = 'none';
                            const error = detailedErrors[Math.floor(Math.random() * detailedErrors.length)];
                            showErrorModal(error);
                            logActivity("Post-success error triggered (random bug)", "error");
                        }, 1000);
                    }
                }
            }, 200);
        }

        function triggerRandomGlitch() {
            const elements = [
                {id: 'title', name: 'Page Title'},
                {id: 'card1', name: 'Portfolio Card'},
                {id: 'card2', name: 'Allocation Card'},
                {id: 'actionButton', name: 'Action Button'}
            ];
            
            const randomElement = elements[Math.floor(Math.random() * elements.length)];
            const element = document.getElementById(randomElement.id);
            
            if (element) {
                element.classList.add('glitch');
                logActivity(`Visual glitch detected on: ${randomElement.name}`, "warning");
                
                setTimeout(() => {
                    element.classList.remove('glitch');
                }, 1000);
            }
            
            // Randomly change numbers
            if (Math.random() > 0.5) {
                document.getElementById('totalAssets').textContent = '$' + (Math.random() * 1000000).toFixed(2);
                document.getElementById('cashBalance').textContent = '$' + (Math.random() * 50000).toFixed(2);
                document.getElementById('monthlyGrowth').textContent = '+$' + (Math.random() * 10000).toFixed(2);
                
                // Randomly change allocation percentages
                document.getElementById('equitiesPct').textContent = Math.floor(Math.random() * 100) + '%';
                document.getElementById('incomePct').textContent = Math.floor(Math.random() * 100) + '%';
                document.getElementById('alternativesPct').textContent = Math.floor(Math.random() * 100) + '%';
                
                logActivity("Financial data randomly changed (known bug #3)", "error");
            }
        }

        function showRandomAnnoyingPopup() {
            const randomMessage = annoyingPopupMessages[Math.floor(Math.random() * annoyingPopupMessages.length)];
            document.getElementById('popupMessage').textContent = randomMessage;
            document.getElementById('annoyingPopup').style.display = 'block';
            
            logActivity(`Annoying popup triggered: "${randomMessage}"`, "warning");
            
            // Auto-hide after random time
            setTimeout(() => {
                closeAnnoyingPopup();
                logActivity("Annoying popup auto-dismissed", "info");
            }, Math.random() * 5000 + 3000);
        }

        function clearLog() {
            document.getElementById('systemLog').innerHTML = '';
            logEntries = [];
            logActivity("System log cleared by user", "info");
        }

        // Initialize display
        updateAttemptDisplay();
        updateStats();
        
        // Start annoying popup interval
        annoyingPopupInterval = setInterval(() => {
            if (Math.random() > 0.3) {
                showRandomAnnoyingPopup();
            }
        }, 10000);
        
        // Randomly blink elements
        setInterval(() => {
            if (Math.random() > 0.7) {
                const randomCard = document.getElementById('card' + (Math.floor(Math.random() * 2) + 1));
                if (randomCard) {
                    randomCard.classList.add('blinking');
                    setTimeout(() => {
                        randomCard.classList.remove('blinking');
                    }, 2000);
                    logActivity("UI element blinking (visual bug)", "warning");
                }
            }
        }, 5000);
        
        // Randomly update system uptime
        setInterval(() => {
            systemUptime = Math.max(70, Math.min(99, systemUptime + (Math.random() * 4 - 2)));
            updateStats();
        }, 15000);

        // Close modal if clicked outside
        window.onclick = function(event) {
            const modal = document.getElementById('errorModal');
            if (event.target === modal) {
                closeModal();
            }
        }
        
        // Make button move when hovering (sometimes)
        document.getElementById('actionButton').addEventListener('mouseover', function() {
            if (Math.random() > 0.7) {
                this.style.transform = 'translate(' + (Math.random() * 20 - 10) + 'px, ' + (Math.random() * 20 - 10) + 'px)';
            }
        });
        
        document.getElementById('actionButton').addEventListener('mouseout', function() {
            this.style.transform = '';
        });
        
        // Add initial log entries
        setTimeout(() => {
            logActivity("System fully initialized with all bugs active", "info");
            logActivity("Warning: Data may be inaccurate due to known issues", "warning");
            logActivity("Transparency mode showing all system errors and glitches", "info");
        }, 1000);
    </script>
</body>
</html>