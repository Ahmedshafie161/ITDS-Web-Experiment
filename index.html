<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WealthTracker - Dashboard Variants (fixed scroll)</title>

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { height: 100%; }
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: #E0F7FA;
      color: #115E59;
      line-height: 1.5;
      /* removed overflow:hidden so scrolling is allowed when needed */
    }

    /* Layout */
    .container {
      display: flex;
      height: 100vh;
      width: 100%;
      min-height: 0; /* allow flex children to shrink */
    }

    .vertical-nav {
      background: #115E59;
      color: #E0F7FA;
      display: flex;
      flex-direction: column;
      width: 240px;
      flex-shrink: 0;
      border-right: 2px solid #14B8A6;
      overflow-y: auto;
    }

    .nav-header { padding: 18px; border-bottom: 2px solid #14B8A6; text-align: center; }
    .nav-header h1 { font-size: 1.2rem; font-weight: 600; }

    .nav-tabs {
      display: flex;
      flex-direction: column;
      gap: 0;
    }

    .nav-tab {
      padding: 14px 12px;
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      border: none;
      background: none;
      color: inherit;
      text-align: left;
      font-weight: 700;
      border-bottom: 1px solid rgba(20,184,166,0.12);
    }

    .nav-tab:hover { background: rgba(255,255,255,0.03); color: #2DD4BF; }
    .nav-tab.active { background: #14B8A6; color: white; }

    .tab-icon { font-size: 1.1rem; width: 26px; flex-shrink: 0; }
    .tab-text { font-size: 0.95rem; }

    /* Dashboard content (right side) */
    .dashboard {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      height: 100vh;
      overflow: hidden; /* keep dashboard container itself from causing double scroll */
      position: relative;
      background: linear-gradient(180deg, rgba(255,255,255,0.0), rgba(0,0,0,0.00));
      min-height: 0; /* critical for child scrolling in flex contexts */
    }

    .tab-content {
      position: relative;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      overflow: hidden;
      height: 100%;
      width: 100%;
      min-height: 0;
    }

    .tab-pane {
      display: none;
      position: absolute;
      inset: 0;
      overflow: hidden;
      background: #ffffff;
      /* make pane a flex column so iframe container can flex */
      display: flex;
      flex-direction: column;
      min-height: 0; /* allow inner scrolling */
    }

    .tab-pane.active {
      display: flex;
    }

    /* make the iframe container a flexible scrollable area */
    .iframe-container {
      position: relative;
      /* fill available space inside .tab-pane */
      flex: 1 1 auto;
      min-height: 0; /* VERY IMPORTANT to allow overflow inside flex */
      overflow: auto;
      -webkit-overflow-scrolling: touch;
      background: white;
    }

    /* iframe fills container */
    .iframe-container iframe {
      width: 100%;
      height: 100%;
      border: 0;
      display: block;
      background: #fff;
    }

    /* FULL-SCREEN survey wrapper and iframe */
    .survey-full {
      position: relative;
      flex: 1 1 auto;
      min-height: 0;
      margin: 0;
      padding: 0;
      overflow: auto;
      background: white;
      -webkit-overflow-scrolling: touch;
    }

    .survey-full iframe {
      position: relative;
      width: 100%;
      height: 100%;
      border: 0;
      margin: 0;
      padding: 0;
      display: block;
      background: white;
    }

    /* Mobile responsiveness: collapse nav into top row */
    @media (max-width: 800px) {
      .container { flex-direction: column; height: 100vh; }
      .vertical-nav { width: 100%; height: auto; display: flex; flex-direction: row; overflow-x: auto; border-right: none; border-bottom: 2px solid #14B8A6; }
      .nav-header { display: none; }
      .nav-tabs { flex-direction: row; gap: 0; }
      .nav-tab { min-width: 180px; flex: 0 0 auto; border-bottom: none; border-right: 1px solid rgba(20,184,166,0.12); }
      .nav-tab:last-child { border-right: none; }
      .dashboard { flex: 1 1 auto; }
      .tab-pane { position: relative; height: calc(100vh - 56px); } /* subtract nav height */
      .iframe-container, .survey-full { position: relative; height: 100%; overflow: auto; min-height: 0; }
      .survey-full iframe { position: relative; height: 100%; width: 100%; }
    }

    /* small devices tweaks */
    @media (max-width: 420px) {
      .nav-tab { min-width: 140px; font-size: 0.88rem; padding: 10px 8px; }
    }

    /* accessibility focus */
    .nav-tab:focus { outline: 3px solid rgba(20,184,166,0.25); outline-offset: -2px; }
  </style>
</head>

<body>
  <div class="container">
    <!-- LEFT NAV -->
    <nav class="vertical-nav" aria-label="Main navigation">
      <div class="nav-header">
        <h1>üí∞ WealthTracker</h1>
      </div>

      <div class="nav-tabs" role="tablist" aria-orientation="vertical">
        <button class="nav-tab active" data-tab="high-high" role="tab" aria-selected="true">
          <span class="tab-icon">üìä</span>
          <span class="tab-text">High Reliability ‚Ä¢ High Transparency</span>
        </button>

        <button class="nav-tab" data-tab="high-low" role="tab" aria-selected="false">
          <span class="tab-icon">üîí</span>
          <span class="tab-text">High Reliability ‚Ä¢ Low Transparency</span>
        </button>

        <button class="nav-tab" data-tab="low-high" role="tab" aria-selected="false">
          <span class="tab-icon">‚ö†Ô∏è</span>
          <span class="tab-text">Low Reliability ‚Ä¢ High Transparency</span>
        </button>

        <button class="nav-tab" data-tab="low-low" role="tab" aria-selected="false">
          <span class="tab-icon">üö´</span>
          <span class="tab-text">Low Reliability ‚Ä¢ Low Transparency</span>
        </button>

        <button class="nav-tab" data-tab="survey" role="tab" aria-selected="false">
          <span class="tab-icon">üìù</span>
          <span class="tab-text">Survey (Experiment)</span>
        </button>
      </div>
    </nav>

    <!-- RIGHT CONTENT -->
    <main class="dashboard" role="main">
      <div class="tab-content" id="tabContent">

        <!-- High-High pane -->
        <section class="tab-pane active" id="high-high" role="tabpanel" aria-hidden="false">
          <div class="iframe-container" aria-hidden="false">
            <!-- if your files have spaces, encode them or replace with hyphens -->
            <iframe src="high-reliable-high-transparency.html" title="High Reliability High Transparency" scrolling="yes"></iframe>
          </div>
        </section>

        <!-- High-Low pane -->
        <section class="tab-pane" id="high-low" role="tabpanel" aria-hidden="true">
          <div class="iframe-container" aria-hidden="true">
            <iframe src="high-reliable-low-transparency.html" title="High Reliability Low Transparency" scrolling="yes"></iframe>
          </div>
        </section>

        <!-- Low-High pane -->
        <section class="tab-pane" id="low-high" role="tabpanel" aria-hidden="true">
          <div class="iframe-container" aria-hidden="true">
            <iframe src="low-reliable-high-transparency.html" title="Low Reliability High Transparency" scrolling="yes"></iframe>
          </div>
        </section>

        <!-- Low-Low pane -->
        <section class="tab-pane" id="low-low" role="tabpanel" aria-hidden="true">
          <div class="iframe-container" aria-hidden="true">
            <iframe src="low-low.html" title="Low Reliability Low Transparency" scrolling="yes"></iframe>
          </div>
        </section>

        <!-- SURVEY: FULL-SCREEN INSIDE TAB -->
        <section class="tab-pane" id="survey" role="tabpanel" aria-hidden="true">
          <div class="survey-full" aria-live="polite">
            <!-- Fullscreen embedded Google Form: KEEP ?embedded=true -->
            <iframe
              src="https://docs.google.com/forms/d/e/1FAIpQLSfdEVcfJBDwNVTDFTSJ9QSgxQZ0E0f1Di_B-Wy6q55uimG4DQ/viewform?embedded=true"
              title="WealthTracker Experiment Survey"
              allowfullscreen
              aria-label="Experiment survey form"
              scrolling="yes">
              Loading‚Ä¶
            </iframe>
          </div>
        </section>

      </div> <!-- .tab-content -->
    </main>
  </div> <!-- .container -->

  <script>
    // Tab switching and accessibility handling
    (function () {
      const tabs = Array.from(document.querySelectorAll('.nav-tab'));
      const panes = Array.from(document.querySelectorAll('.tab-pane'));

      function setActive(tabBtn) {
        const targetId = tabBtn.getAttribute('data-tab');

        // Update tabs
        tabs.forEach(t => {
          const isActive = t === tabBtn;
          t.classList.toggle('active', isActive);
          t.setAttribute('aria-selected', isActive ? 'true' : 'false');
        });

        // Update panes
        panes.forEach(p => {
          const isTarget = p.id === targetId;
          p.classList.toggle('active', isTarget);
          p.setAttribute('aria-hidden', isTarget ? 'false' : 'true');

          // keep iframe src loaded to preserve internal state (you can change
          // to unload inactive iframes later)
        });

        // ensure survey iframe resizes correctly after showing
        setTimeout(() => {
          const activeIframe = document.querySelector('.tab-pane.active iframe');
          if (activeIframe) {
            // forcing reflow for some browsers so iframe fills correctly
            activeIframe.style.display = 'none';
            setTimeout(() => activeIframe.style.display = 'block', 20);
          }
        }, 80);
      }

      // Wire up clicks + keyboard navigation
      tabs.forEach(tab => {
        tab.addEventListener('click', () => setActive(tab));
        tab.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            setActive(tab);
          }
          // left/right or up/down to navigate
          if (e.key === 'ArrowDown' || e.key === 'ArrowRight') {
            e.preventDefault();
            const next = tabs[(tabs.indexOf(tab) + 1) % tabs.length];
            next.focus();
          }
          if (e.key === 'ArrowUp' || e.key === 'ArrowLeft') {
            e.preventDefault();
            const prev = tabs[(tabs.indexOf(tab) - 1 + tabs.length) % tabs.length];
            prev.focus();
          }
        });
      });

      // Set initial active state (ensure exactly one active)
      const initial = document.querySelector('.nav-tab.active') || tabs[0];
      if (initial) setActive(initial);

      // Handle window resize to help iframe fill area on mobile
      window.addEventListener('resize', () => {
        const activeIframe = document.querySelector('.tab-pane.active iframe');
        if (activeIframe) {
          activeIframe.style.height = '100%';
        }
      });

      // Prevent body scroll when interacting with iframes on touch devices (passive only)
      document.body.addEventListener('touchmove', function () {}, { passive: true });
    })();
  </script>
</body>
</html>
